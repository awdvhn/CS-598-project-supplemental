function dydtarbi=dydtunforced(t,y,N,kg1,kg2,d_g1,d_g2,d_c,d_NL1,d_NL2,m1,m2,coupling,kNL1,kNL2,kNL_L1,kNL_L2,beta)
%xi=0.005;
dydtarbi=zeros(4*N,1);
dydtarbi(1)=y(2);%dydt(4n+1)=dx/dt
dydtarbi(2)=(-kg1(1)*y(1)-kNL1(1)*abs(y(1)-y(5))^(beta-1)*(y(1)-y(5))-kNL_L1(1)*(y(1)-y(5))-coupling(1)*(y(1)-y(3))-d_g1(1)*y(2)-d_c(1)*(y(2)-y(4))-d_NL1(1)*(y(2)-y(6)))/m1(1);
dydtarbi(3)=y(4);%dydt(4n+3)=dy/dt
dydtarbi(4)=(-kg2(1)*y(3)-kNL2(1)*abs(y(3)-y(7))^(beta-1)*(y(3)-y(7))-kNL_L2(1)*(y(3)-y(7))-coupling(1)*(y(3)-y(1))-d_g2(1)*y(4)-d_c(1)*(y(4)-y(2))-d_NL2(1)*(y(4)-y(8)))/m2(1);
    dydtarbi(5:4:4*N-7)= y(6:4:4*N-6);
%     A= -kg1(2:N-1).*y(5:4:4*N-7)-kNL1(1:N-2).*(y(5:4:4*N-7)-y(1:4:4*N-11)).^3;%-...
%                          %kNL1(2:N-1).*(y(5:4:4*N-7)-y(9:4:4*N-3)).^3-coupling(2:N-1).*(y(5:4:4*N-7)-y(7:4:4*N-5));
% %                          d_g1(2:N-1).*y(6:4:4*N-6)-d_c(2:N-1).*(y(6:4:4*N-6)-y(8:4:4*N-4))-...
% %                          d_NL1(1:N-2).*(y(6:4:4*N-6)-y(2:4:4*N-10))-d_NL1(2:N-1).*(y(6:4:4*N-6)-y(10:4:4*N-2));
%     size(A)
    dydtarbi(6:4:4*N-6)= (-kg1(2:N-1).*y(5:4:4*N-7)-kNL_L1(1:N-2).*(y(5:4:4*N-7)-y(1:4:4*N-11))-...
                         kNL1(1:N-2).*abs(y(5:4:4*N-7)-y(1:4:4*N-11)).^(beta-1).*(y(5:4:4*N-7)-y(1:4:4*N-11))-...
                         kNL1(2:N-1).*abs(y(5:4:4*N-7)-y(9:4:4*N-3)).^(beta-1).*(y(5:4:4*N-7)-y(9:4:4*N-3))-...
                         kNL_L1(2:N-1).*(y(5:4:4*N-7)-y(9:4:4*N-3))-...
                         coupling(2:N-1).*(y(5:4:4*N-7)-y(7:4:4*N-5))-...
                         d_g1(2:N-1).*y(6:4:4*N-6)-d_c(2:N-1).*(y(6:4:4*N-6)-y(8:4:4*N-4))-...
                         d_NL1(1:N-2).*(y(6:4:4*N-6)-y(2:4:4*N-10))-d_NL1(2:N-1).*(y(6:4:4*N-6)-y(10:4:4*N-2)))./m1(2:N-1);
    dydtarbi(7:4:4*N-5)= y(8:4:4*N-4);
    dydtarbi(8:4:4*N-4)= (-kg2(2:N-1).*y(7:4:4*N-5)-kNL_L2(1:N-2).*(y(7:4:4*N-5)-y(3:4:4*N-9))-...
                         kNL2(1:N-2).*abs(y(7:4:4*N-5)-y(3:4:4*N-9)).^(beta-1).*(y(7:4:4*N-5)-y(3:4:4*N-9))-...
                         kNL2(2:N-1).*abs(y(7:4:4*N-5)-y(11:4:4*N-1)).^(beta-1).*(y(7:4:4*N-5)-y(11:4:4*N-1))-...
                         kNL_L2(2:N-1).*(y(7:4:4*N-5)-y(11:4:4*N-1))-...
                         coupling(2:N-1).*(y(7:4:4*N-5)-y(5:4:4*N-7))-...
                         d_g2(2:N-1).*y(8:4:4*N-4)-d_c(2:N-1).*(y(8:4:4*N-4)-y(6:4:4*N-6))-...
                         d_NL2(1:N-2).*(y(8:4:4*N-4)-y(4:4:4*N-8))-d_NL1(2:N-1).*(y(8:4:4*N-4)-y(12:4:4*N)))./m2(2:N-1);
dydtarbi(4*N-3)=y(4*N-2);
dydtarbi(4*N-2)=(-kg1(N)*y(4*N-3)-kNL1(N-1)*abs(y(4*N-3)-y(4*N-7))^(beta-1)*(y(4*N-3)-y(4*N-7))-...
                kNL_L1(N-1)*(y(4*N-3)-y(4*N-7))-coupling(N)*(y(4*N-3)-y(4*N-1))-d_g1(N)*y(4*N-2)-...
                d_c(N)*(y(4*N-2)-y(4*N))-d_NL1(N-1)*(y(4*N-2)-y(4*N-6)))/m1(N);
dydtarbi(4*N-1)=y(4*N);
dydtarbi(4*N)=(-kg2(N)*y(4*N-1)-kNL2(N-1)*abs(y(4*N-1)-y(4*N-5))^(beta-1)*(y(4*N-1)-y(4*N-5))-...
              kNL_L2(N-1)*(y(4*N-1)-y(4*N-5))-coupling(N)*(y(4*N-1)-y(4*N-3))-d_g2(N)*y(4*N)-...
              d_c(N)*(y(4*N)-y(4*N-2))-d_NL2(N-1)*(y(4*N)-y(4*N-4)))/m2(N);
end